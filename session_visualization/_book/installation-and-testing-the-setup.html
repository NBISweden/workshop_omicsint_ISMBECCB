<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Cytoscape_R</title>
  <meta name="description" content="Cytoscape_R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Cytoscape_R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Cytoscape_R" />
  
  
  

<meta name="author" content="Ashfaq Ali" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="Cytoscape_tuturial.html"><a href="#installation-and-testing-the-setup"><i class="fa fa-check"></i><b>1</b> Installation and testing the setup</a><ul>
<li class="chapter" data-level="1.1" data-path="Cytoscape_tuturial.html"><a href="#conda-environment"><i class="fa fa-check"></i><b>1.1</b> Conda Environment</a></li>
<li class="chapter" data-level="1.2" data-path="Cytoscape_tuturial.html"><a href="#installation-of-cytoscape-apps-using-r"><i class="fa fa-check"></i><b>1.2</b> Installation of cytoscape apps using R</a></li>
<li class="chapter" data-level="1.3" data-path="Cytoscape_tuturial.html"><a href="#intuition-behind-using-rcy3-to-analyze-networks-with-cytoscape."><i class="fa fa-check"></i><b>1.3</b> Intuition behind using RCy3 to analyze networks with cytoscape.</a></li>
<li class="chapter" data-level="1.4" data-path="Cytoscape_tuturial.html"><a href="#data-preparation"><i class="fa fa-check"></i><b>1.4</b> Data preparation</a></li>
<li class="chapter" data-level="1.5" data-path="Cytoscape_tuturial.html"><a href="#retrieve-networks-for-genes-proteins-of-interest"><i class="fa fa-check"></i><b>1.5</b> retrieve networks for Genes/ proteins of interest</a></li>
<li class="chapter" data-level="1.6" data-path="Cytoscape_tuturial.html"><a href="#to-do"><i class="fa fa-check"></i><b>1.6</b> To do</a></li>
<li class="chapter" data-level="1.7" data-path="Cytoscape_tuturial.html"><a href="#layout-and-visually-style-the-resulting-networks"><i class="fa fa-check"></i><b>1.7</b> layout and visually style the resulting networks</a></li>
<li class="chapter" data-level="1.8" data-path="Cytoscape_tuturial.html"><a href="#creating-a-degree-filter"><i class="fa fa-check"></i><b>1.8</b> Creating a degree filter</a></li>
<li class="chapter" data-level="1.9" data-path="Cytoscape_tuturial.html"><a href="#creating-a-column-filter"><i class="fa fa-check"></i><b>1.9</b> Creating a column filter</a></li>
<li class="chapter" data-level="1.10" data-path="Cytoscape_tuturial.html"><a href="#generate-own-networks-using-co-expression-analyse"><i class="fa fa-check"></i><b>1.10</b> Generate own networks using co-expression analyse</a></li>
<li class="chapter" data-level="1.11" data-path="Cytoscape_tuturial.html"><a href="#bonus-exercises"><i class="fa fa-check"></i><b>1.11</b> Bonus exercises</a></li>
<li class="chapter" data-level="1.12" data-path="Cytoscape_tuturial.html"><a href="#end-the-session"><i class="fa fa-check"></i><b>1.12</b> End the session</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cytoscape_R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Cytoscape_R</h1>
<p class="author"><em>Ashfaq Ali</em></p>
<p class="date"><em>21/09/2020</em></p>
</div>
<div id="installation-and-testing-the-setup" class="section level1">
<h1><span class="header-section-number">1</span> Installation and testing the setup</h1>
<div id="conda-environment" class="section level2">
<h2><span class="header-section-number">1.1</span> Conda Environment</h2>
<p>If you have the course conda environment set up, please activate and use that for this session. Otherwise use “env-cytoscape.yml” file to create the environment.</p>
<div class="block-title-parent">
<div class="block-title small">
bash
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ex">conda</span> env create -f env-cytoscape.yml</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="ex">conda</span> activate cyto</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">## If you have the course conda environment set up, please use that for this session.</span></a></code></pre></div>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">suppressMessages</span>(<span class="kw">library</span>(dplyr))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">suppressMessages</span>(<span class="kw">library</span>(RCy3))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">suppressMessages</span>(<span class="kw">library</span>(readxl))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">suppressMessages</span>(<span class="kw">library</span>(tidyverse))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">suppressMessages</span>(<span class="kw">library</span>(readxl))</a></code></pre></div>
</div>
Start the cytoscape app and rstudio using following commands
<div class="block-title-parent">
<div class="block-title small">
bash
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="ex">rstudio</span> <span class="kw">&amp;</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="ex">cytoscape</span> <span class="kw">&amp;</span></a></code></pre></div>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">cytoscapePing</span>()</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">cytoscapeVersionInfo</span>()</a></code></pre></div>
<pre><code>## [1] &quot;You are connected to Cytoscape!&quot;
##       apiVersion cytoscapeVersion 
##             &quot;v1&quot;          &quot;3.8.0&quot;</code></pre>
</div>
</div>
<div id="installation-of-cytoscape-apps-using-r" class="section level2">
<h2><span class="header-section-number">1.2</span> Installation of cytoscape apps using R</h2>
<p>To install cytoscape apps one can use the Cytoscape GUI through app manager or can install directly from R using the following code.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">installation_responses &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#list of app to install</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">cyto_app_toinstall &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;clustermaker2&quot;</span>, <span class="st">&quot;enrichmentmap&quot;</span>, <span class="st">&quot;autoannotate&quot;</span>, <span class="st">&quot;wordcloud&quot;</span>, <span class="st">&quot;stringapp&quot;</span>, <span class="st">&quot;aMatReader&quot;</span>, <span class="st">&quot;yFiles Layout Algorithms&quot;</span>, <span class="st">&quot;enhancedGraphics&quot;</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">cytoscape_version &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>( <span class="kw">cytoscapeVersionInfo</span>()[<span class="st">&#39;cytoscapeVersion&#39;</span>],<span class="dt">split =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>))</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="cf">if</span>(<span class="kw">length</span>(cytoscape_version) <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">as.numeric</span>(cytoscape_version[<span class="dv">1</span>]<span class="op">&gt;=</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">   <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">as.numeric</span>(cytoscape_version[<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">7</span>)){</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cyto_app_toinstall)){</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">    <span class="co">#check to see if the app is installed.  Only install it if it hasn&#39;t been installed</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">    <span class="cf">if</span>(<span class="op">!</span><span class="kw">grep</span>(<span class="kw">commandsGET</span>(<span class="kw">paste</span>(<span class="st">&quot;apps status app=</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, cyto_app_toinstall[<span class="dv">1</span>],<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)), </a>
<a class="sourceLine" id="cb6-12" data-line-number="12">             <span class="dt">pattern =</span> <span class="st">&quot;status: Installed&quot;</span>)){</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">      installation_response &lt;-<span class="kw">commandsGET</span>(<span class="kw">paste</span>(<span class="st">&quot;apps install app=</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, </a>
<a class="sourceLine" id="cb6-14" data-line-number="14">                                                cyto_app_toinstall[i],<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">      installation_responses &lt;-<span class="st"> </span><span class="kw">c</span>(installation_responses,installation_response)</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">    } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">      installation_responses &lt;-<span class="st"> </span><span class="kw">c</span>(installation_responses,<span class="st">&quot;already installed&quot;</span>)</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">    }</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">  }</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">  installation_summary &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">name =</span> cyto_app_toinstall, </a>
<a class="sourceLine" id="cb6-21" data-line-number="21">                                     <span class="dt">status =</span> installation_responses)</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb6-23" data-line-number="23">  knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">list</span>(installation_summary),</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">  <span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">caption =</span> <span class="st">&#39;A Summary of automated app installation&#39;</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25">)</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">}</a></code></pre></div>
</div>
</div>
<div id="intuition-behind-using-rcy3-to-analyze-networks-with-cytoscape." class="section level2">
<h2><span class="header-section-number">1.3</span> Intuition behind using RCy3 to analyze networks with cytoscape.</h2>
<p>Cytoscape(www.cytoscape.org) is probably the most popular applications for network analysis and visualization with GUI. In this session, we will learn about new capabilities to integrate Cytoscape into programmatic workflows and pipelines using R. Apart from programmatic workflow, the access through R allows direct access to network analyses as being part of an ongoing analyses instead of a separate instance. This also makes analyses steps more explicit hence more reproducible.</p>
<p>We have already been introduced to network biology themes and concepts, therefor we will translate these into Cytoscape terms for practical applications. This tutorial will be a hands-on session working towards accessing and controlling Cytoscape from R to perform a network analysis. We will go through the following themes that are usually required in network visualization and analyses.</p>
<ul>
<li>retrieve networks for Genes/ proteins of interest</li>
<li>layout and visually style the resulting networks</li>
<li>import external data and map them onto a network</li>
<li>filter networks and customize styling</li>
<li>perform co-expression analyses and create your own co-expression network</li>
<li>visualize the results and map attributes to user created networks</li>
</ul>
</div>
<div id="data-preparation" class="section level2">
<h2><span class="header-section-number">1.4</span> Data preparation</h2>
<p>We will be using data from the Charge consortium in which they have analyzed quite large cohort with association of methylation and gene expression with Age. We will use some of the results for visualization in Cytoscape. In addition there is a list of proteins and coefficients from a proteomics data-set provided in the <strong>/Data/AgeingTopProteins.txt</strong>. All these data aim to identify markers associated with age. We can try and find overlaps in these data-sets using network analyses in cytoscape.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">AgeingExpMeth &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;./Data/AgeExpMethSig.xlsx&quot;</span>,   <span class="dt">skip =</span> <span class="dv">0</span>) <span class="co">## Provide the path to the file with data</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">Age_prot &lt;-<span class="st"> </span><span class="kw">read_table2</span>(<span class="st">&quot;./Data/AgeingTopProteins.txt&quot;</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">Age_exp &lt;-<span class="st"> </span>AgeingExpMeth <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">arrange</span>(<span class="st">`</span><span class="dt">ExpAgeP-value</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_head</span>(<span class="dt">n=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">Age_meth &lt;-<span class="st"> </span>AgeingExpMeth <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="st">`</span><span class="dt">MethAgeP-value</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice_head</span>(<span class="dt">n=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw">rownames</span>(Age_exp) &lt;-<span class="st"> </span>Age_exp<span class="op">$</span>Gene</a></code></pre></div>
</div>
<p>To get an overview of what commands and functions are available through “RCy3”, please have a look at the help pages. More details with examples are also available through package vignettes.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">help</span>(<span class="dt">package=</span>RCy3)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">browseVignettes</span>(<span class="st">&quot;RCy3&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="retrieve-networks-for-genes-proteins-of-interest" class="section level2">
<h2><span class="header-section-number">1.5</span> retrieve networks for Genes/ proteins of interest</h2>
Get a subset of genes of interest from our Ageing data:
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">AgeingExpe_string_interaction_cmd &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&#39;string protein query taxonID=9606 cutoff=0.9 query=&#39;</span>, <span class="kw">paste</span>(Age_exp<span class="op">$</span>Gene, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>),<span class="st">&#39;&quot;&#39;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">commandsGET</span>(AgeingExpe_string_interaction_cmd )</a></code></pre></div>
<pre><code>## [1] &quot;Loaded network &#39;String Network - 11&#39; with 109 nodes and 98 edges&quot;</code></pre>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">renameNetwork</span>(<span class="st">&quot;AgeingExpeNet&quot;</span>)</a></code></pre></div>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">AgeingMeth_string_interaction_cmd &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&#39;string protein query taxonID=9606 cutoff=0.9 query=&#39;</span>, <span class="kw">paste</span>(Age_meth<span class="op">$</span>Gene, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>),<span class="st">&#39;&quot;&#39;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">commandsGET</span>(AgeingMeth_string_interaction_cmd)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">renameNetwork</span>(<span class="st">&quot;AgeingMethNet&quot;</span>)</a></code></pre></div>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">AgeingProt_string_interaction_cmd &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&#39;string protein query taxonID=9606 limit=150 cutoff=0.9 query=&#39;</span>, <span class="kw">paste</span>(Age_prot<span class="op">$</span>protein, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>),<span class="st">&#39;&quot;&#39;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">test &lt;-<span class="kw">commandsGET</span>(AgeingProt_string_interaction_cmd)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">renameNetwork</span>(<span class="st">&quot;AgeingProtNet&quot;</span>)</a></code></pre></div>
</div>
<p>Let us have a look at what networks we have.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">getNetworkList</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;String Network - 11&quot;           
##  [2] &quot;Network_3&quot;                     
##  [3] &quot;String Network - 7&quot;            
##  [4] &quot;Coexpression_network&quot;          
##  [5] &quot;Network_2&quot;                     
##  [6] &quot;Ageing: highly connected nodes&quot;
##  [7] &quot;Network&quot;                       
##  [8] &quot;String Network - 9&quot;            
##  [9] &quot;Network_1&quot;                     
## [10] &quot;String Network - 6&quot;            
## [11] &quot;String Network - 10&quot;           
## [12] &quot;Network_5&quot;                     
## [13] &quot;AgeingMethNet&quot;                 
## [14] &quot;String Network - 5&quot;            
## [15] &quot;String Network - 8&quot;            
## [16] &quot;Ageing: highly connected nodes&quot;
## [17] &quot;Network_4&quot;                     
## [18] &quot;Ageing: highly connected nodes&quot;
## [19] &quot;AgeingProtNet&quot;                 
## [20] &quot;Ageing: highly connected nodes&quot;
## [21] &quot;AgeingExpeNet&quot;</code></pre>
</div>
<p>To work with a respective network, we need to set the environment we wish to work with.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">setCurrentNetwork</span>(<span class="dt">network=</span><span class="st">&quot;AgeingExpeNet&quot;</span>)</a></code></pre></div>
</div>
<p>Save the original network to a file.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">getwd</span>(), <span class="st">&quot;/Data/&quot;</span>,<span class="st">&quot;ExpnetworkOriginal.png&quot;</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co"># initial_string_network_png_file_name &lt;- file.path(getwd(), &quot;/Path/to/your/network.png&quot;)</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw">exportImage</span>(path, <span class="dt">type =</span> <span class="st">&quot;png&quot;</span>, <span class="dt">resolution =</span> <span class="dv">300</span>)</a></code></pre></div>
<pre><code>##                                                                                file 
## &quot;/Users/cob-aaf/Documents/GitHub/session_visualization/Data/ExpnetworkOriginal.png&quot;</code></pre>
</div>
<p><strong><em>If cytoscape hangs waiting for user response if file already exists. Remove it first</em></strong></p>
</div>
<div id="to-do" class="section level2">
<h2><span class="header-section-number">1.6</span> To do</h2>
<ol style="list-style-type: decimal">
<li>Can you save the <strong>“AgeingMethNet”</strong> and <strong>“AgeingProtNet”</strong> to the respective files?</li>
<li>Use your desired node attributes among the cytoscape network columns to improve visualization.</li>
</ol>
</div>
<div id="layout-and-visually-style-the-resulting-networks" class="section level2">
<h2><span class="header-section-number">1.7</span> layout and visually style the resulting networks</h2>
<p>Now that we have a few networks loaded in cytoscape, let us work with those based on our interest.
Change the layout of the network and save to a new file.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">layouts &lt;-<span class="st"> </span><span class="kw">getLayoutNames</span>() <span class="co">## Access the available lyouts in cytoscape</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">layoutNetwork</span>(layouts[<span class="dv">3</span>]) <span class="co">## Change the layout to circular</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="kw">exportImage</span>(path, <span class="dt">type =</span> <span class="st">&quot;png&quot;</span>, <span class="dt">resolution =</span> <span class="dv">300</span>) <span class="co">## Cytoscape will hang as you are trying to overwite an existing file</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">path &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">getwd</span>(), <span class="st">&quot;/Data/&quot;</span>,<span class="st">&quot;ExpnetworkOriginalCircular.png&quot;</span>) <span class="co"># update the path</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="kw">exportImage</span>(path, <span class="dt">type =</span> <span class="st">&quot;png&quot;</span>, <span class="dt">resolution =</span> <span class="dv">300</span>) <span class="co">## Cytoscape will hang as you are trying to overwite an existing file</span></a></code></pre></div>
<pre><code>##                                                                                file 
## &quot;/Users/cob-aaf/Documents/GitHub/session_visualization/Data/ExpnetworkOriginal.png&quot; 
##                                                                                        file 
## &quot;/Users/cob-aaf/Documents/GitHub/session_visualization/Data/ExpnetworkOriginalCircular.png&quot;</code></pre>
</div>
<p>Get available parameters for a specific layout.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">getLayoutPropertyNames</span>(<span class="dt">layout.name=</span><span class="st">&#39;force-directed&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;Available arguments for &#39;layout force-directed&#39;:&quot;
##  [1] &quot;defaultEdgeWeight&quot;       
##  [2] &quot;defaultNodeMass&quot;         
##  [3] &quot;defaultSpringCoefficient&quot;
##  [4] &quot;defaultSpringLength&quot;     
##  [5] &quot;edgeAttribute&quot;           
##  [6] &quot;isDeterministic&quot;         
##  [7] &quot;maxWeightCutoff&quot;         
##  [8] &quot;minWeightCutoff&quot;         
##  [9] &quot;network&quot;                 
## [10] &quot;nodeAttribute&quot;           
## [11] &quot;nodeList&quot;                
## [12] &quot;numIterations&quot;           
## [13] &quot;singlePartition&quot;         
## [14] &quot;type&quot;</code></pre>
</div>
<p>Apply the layout by changing parameters again</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">layoutNetwork</span>(<span class="st">&#39;force-directed defaultSpringCoefficient=0.0000008 defaultSpringLength=70&#39;</span>)</a></code></pre></div>
</div>
<p>Overlay our expression data on the String network.
To do this we will be using the loadTableData function from RCy3. It is important to make sure that that your identifiers types match up. You can check what is used by String by pulling in the column names of the node attribute table.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">getTableColumnNames</span>(<span class="st">&#39;node&#39;</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;SUID&quot;                               
##  [2] &quot;shared name&quot;                        
##  [3] &quot;name&quot;                               
##  [4] &quot;selected&quot;                           
##  [5] &quot;stringdb::canonical name&quot;           
##  [6] &quot;display name&quot;                       
##  [7] &quot;stringdb::full name&quot;                
##  [8] &quot;stringdb::database identifier&quot;      
##  [9] &quot;stringdb::description&quot;              
## [10] &quot;@id&quot;                                
## [11] &quot;stringdb::namespace&quot;                
## [12] &quot;stringdb::node type&quot;                
## [13] &quot;query term&quot;                         
## [14] &quot;stringdb::sequence&quot;                 
## [15] &quot;stringdb::species&quot;                  
## [16] &quot;stringdb::STRING style&quot;             
## [17] &quot;stringdb::enhancedLabel Passthrough&quot;
## [18] &quot;compartment::cytoskeleton&quot;          
## [19] &quot;compartment::cytosol&quot;               
## [20] &quot;compartment::endoplasmic reticulum&quot; 
## [21] &quot;compartment::endosome&quot;              
## [22] &quot;compartment::extracellular&quot;         
## [23] &quot;compartment::golgi apparatus&quot;       
## [24] &quot;compartment::lysosome&quot;              
## [25] &quot;compartment::mitochondrion&quot;         
## [26] &quot;compartment::nucleus&quot;               
## [27] &quot;compartment::peroxisome&quot;            
## [28] &quot;compartment::plasma membrane&quot;       
## [29] &quot;stringdb::interactor score&quot;         
## [30] &quot;stringdb::structures&quot;               
## [31] &quot;target::development level&quot;          
## [32] &quot;target::family&quot;                     
## [33] &quot;tissue::adrenal gland&quot;              
## [34] &quot;tissue::blood&quot;                      
## [35] &quot;tissue::bone&quot;                       
## [36] &quot;tissue::bone marrow&quot;                
## [37] &quot;tissue::eye&quot;                        
## [38] &quot;tissue::gall bladder&quot;               
## [39] &quot;tissue::heart&quot;                      
## [40] &quot;tissue::intestine&quot;                  
## [41] &quot;tissue::kidney&quot;                     
## [42] &quot;tissue::liver&quot;                      
## [43] &quot;tissue::lung&quot;                       
## [44] &quot;tissue::muscle&quot;                     
## [45] &quot;tissue::nervous system&quot;             
## [46] &quot;tissue::pancreas&quot;                   
## [47] &quot;tissue::saliva&quot;                     
## [48] &quot;tissue::skin&quot;                       
## [49] &quot;tissue::spleen&quot;                     
## [50] &quot;tissue::stomach&quot;                    
## [51] &quot;tissue::thyroid gland&quot;              
## [52] &quot;tissue::urine&quot;                      
## [53] &quot;ExpAgeUp&quot;                           
## [54] &quot;ExpAgeDown&quot;                         
## [55] &quot;MethAgeUp&quot;                          
## [56] &quot;MethAgeDown&quot;                        
## [57] &quot;ExpMethUp&quot;                          
## [58] &quot;ExpMethDown&quot;                        
## [59] &quot;Gene&quot;                               
## [60] &quot;ExpAgeP-value&quot;                      
## [61] &quot;ExpAgeDirection&quot;                    
## [62] &quot;MethAgeP-value&quot;                     
## [63] &quot;MethAgeDirection&quot;                   
## [64] &quot;ExpMethP-value&quot;                     
## [65] &quot;ExpMethDirection&quot;                   
## [66] &quot;TopMediator&quot;                        
## [67] &quot;Z-score&quot;                            
## [68] &quot;MedP-value&quot;                         
## [69] &quot;NoCpGsTested&quot;                       
## [70] &quot;NoBonferroniSig&quot;                    
## [71] &quot;degree.layout&quot;</code></pre>
</div>
<p>The column “display name” contains gene names which are also found in our Ageing Expression data-set.
To import our expression data we will match our data-set to the “display name” node attribute.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">?loadTableData</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="kw">loadTableData</span>(<span class="dt">data=</span> <span class="kw">as.data.frame</span>(Age_exp),  <span class="dt">table.key.column =</span> <span class="st">&quot;display name&quot;</span>, <span class="dt">data.key.column=</span> <span class="st">&quot;Gene&quot;</span>)  <span class="co">#default data.frame key is row.names</span></a></code></pre></div>
<pre><code>## [1] &quot;Success: Data loaded in defaultnode table&quot;</code></pre>
</div>
<p>Modify the Visual Style Create your own visual style to visualize your expression data on the String network.</p>
<p>Start with a default style</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">my.style.name =<span class="st"> &quot;AgeingStyle&quot;</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">defaults.list &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">NODE_SHAPE=</span><span class="st">&quot;ellipse&quot;</span>,</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">                 <span class="dt">NODE_SIZE=</span><span class="dv">60</span>,</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">                 <span class="dt">NODE_FILL_COLOR=</span><span class="st">&quot;#AAAAAA&quot;</span>,</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">                 <span class="dt">EDGE_TRANSPARENCY=</span><span class="dv">120</span>)</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">node.label.map &lt;-<span class="st"> </span><span class="kw">mapVisualProperty</span>(<span class="st">&#39;node label&#39;</span>,<span class="st">&#39;display name&#39;</span>,<span class="st">&#39;p&#39;</span>) <span class="co"># p for passthrough; nothing else needed</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="kw">createVisualStyle</span>(my.style.name, defaults.list, <span class="kw">list</span>(node.label.map))</a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="kw">setVisualStyle</span>(<span class="dt">style.name=</span>my.style.name)</a></code></pre></div>
<pre><code>##                 message 
## &quot;Visual Style applied.&quot;</code></pre>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">min.Exp.zscore =<span class="st"> </span><span class="kw">min</span>(Age_exp<span class="op">$</span><span class="st">`</span><span class="dt">Z-score</span><span class="st">`</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">max.Exp.zscore  =<span class="st"> </span><span class="kw">max</span>(Age_exp<span class="op">$</span><span class="st">`</span><span class="dt">Z-score</span><span class="st">`</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">#mid..Exp.zscore = mean</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4">data.values =<span class="st"> </span><span class="kw">c</span>(min.Exp.zscore, <span class="kw">mean</span>(min.Exp.zscore,max.Exp.zscore) ,max.Exp.zscore)</a></code></pre></div>
</div>
<p>Next, we use the RColorBrewer package to help us pick good colors to pair with our data values.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="kw">display.brewer.all</span>(<span class="kw">length</span>(data.values), <span class="dt">colorblindFriendly=</span><span class="ot">TRUE</span>, <span class="dt">type=</span><span class="st">&quot;div&quot;</span>) <span class="co"># div,qual,seq,all</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"></a>
<a class="sourceLine" id="cb31-4" data-line-number="4"></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">node.colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="kw">length</span>(data.values), <span class="st">&quot;RdYlBu&quot;</span>)))</a></code></pre></div>
<img src="_main_files/figure-html/external_data_color-1.svg" width="672" style="display: block; margin: auto auto auto 0;" />
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">setNodeColorMapping</span>(<span class="st">&quot;Z-score&quot;</span>, data.values, node.colors, <span class="dt">style.name=</span>my.style.name)</a></code></pre></div>
</div>
<p>Change the size of the node to be correlated with the Age p-value.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">setNodeSizeMapping</span>(<span class="dt">table.column =</span> <span class="st">&#39;ExpAgeP-value&#39;</span>, </a>
<a class="sourceLine" id="cb33-2" data-line-number="2">                   <span class="dt">table.column.values =</span> <span class="kw">c</span>(<span class="kw">min</span>(Age_exp<span class="op">$</span><span class="st">`</span><span class="dt">ExpAgeP-value</span><span class="st">`</span>), </a>
<a class="sourceLine" id="cb33-3" data-line-number="3">                                           <span class="kw">mean</span>(Age_exp<span class="op">$</span><span class="st">`</span><span class="dt">ExpAgeP-value</span><span class="st">`</span>), </a>
<a class="sourceLine" id="cb33-4" data-line-number="4">                                           <span class="kw">max</span>(Age_exp<span class="op">$</span><span class="st">`</span><span class="dt">ExpAgeP-value</span><span class="st">`</span>)), </a>
<a class="sourceLine" id="cb33-5" data-line-number="5">                   <span class="dt">sizes =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">150</span>), <span class="dt">mapping.type =</span> <span class="st">&quot;c&quot;</span>, <span class="dt">style.name =</span> my.style.name)</a></code></pre></div>
</div>
</div>
<div id="creating-a-degree-filter" class="section level2">
<h2><span class="header-section-number">1.8</span> Creating a degree filter</h2>
<p>Every node in a network has a Degree property, which corresponds to the number of edges connecting the node to other nodes, either as a target or source. Filtering based on node degree is a useful way to remove nodes with too few (or too many) connections.</p>
<p>In this example we want to exclude low degree nodes, e.g., those with only 0, 1 or 2 connections:</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">createDegreeFilter</span>(<span class="st">&#39;degree filter&#39;</span>, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="st">&#39;IS_NOT_BETWEEN&#39;</span>)</a></code></pre></div>
<pre><code>## $nodes
##  [1] &quot;9606.ENSP00000357307&quot; &quot;9606.ENSP00000360609&quot;
##  [3] &quot;9606.ENSP00000355759&quot; &quot;9606.ENSP00000398124&quot;
##  [5] &quot;9606.ENSP00000346088&quot; &quot;9606.ENSP00000352995&quot;
##  [7] &quot;9606.ENSP00000221801&quot; &quot;9606.ENSP00000278616&quot;
##  [9] &quot;9606.ENSP00000265165&quot; &quot;9606.ENSP00000479618&quot;
## [11] &quot;9606.ENSP00000368880&quot; &quot;9606.ENSP00000225916&quot;
## [13] &quot;9606.ENSP00000312397&quot; &quot;9606.ENSP00000388107&quot;
## [15] &quot;9606.ENSP00000272317&quot; &quot;9606.ENSP00000263253&quot;
## [17] &quot;9606.ENSP00000262367&quot; &quot;9606.ENSP00000348461&quot;
## [19] &quot;9606.ENSP00000341551&quot; &quot;9606.ENSP00000304697&quot;
## [21] &quot;9606.ENSP00000441543&quot; &quot;9606.ENSP00000332973&quot;
## [23] &quot;9606.ENSP00000360532&quot;
## 
## $edges
## [1] NA</code></pre>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">createSubnetwork</span>(<span class="dt">subnetwork.name =</span><span class="st">&#39;Ageing: highly connected nodes&#39;</span>)</a></code></pre></div>
<pre><code>## network 
##  268046</code></pre>
</div>
</div>
<div id="creating-a-column-filter" class="section level2">
<h2><span class="header-section-number">1.9</span> Creating a column filter</h2>
<p>We could also filter the network based on any of the column data available. Let us filter nodes that come from “target” database belonging to “family” “TF”.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">createColumnFilter</span>(<span class="dt">filter.name=</span><span class="st">&#39;transcription factors&#39;</span>, <span class="dt">column=</span><span class="st">&quot;target::family&quot;</span>, <span class="st">&quot;TF&quot;</span>, <span class="st">&quot;IS&quot;</span>, <span class="dt">network =</span> <span class="st">&quot;Ageing: highly connected nodes&quot;</span>)</a></code></pre></div>
<pre><code>## $nodes
## [1] &quot;9606.ENSP00000265165&quot; &quot;9606.ENSP00000341551&quot; &quot;9606.ENSP00000479618&quot; &quot;9606.ENSP00000332973&quot; &quot;9606.ENSP00000360532&quot;
## [6] &quot;9606.ENSP00000368880&quot; &quot;9606.ENSP00000398124&quot;
## 
## $edges
## [1] NA</code></pre>
</div>
<p>Now we will select the nodes from the family and color them differently in the network.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">nodes &lt;-<span class="st"> </span><span class="kw">getSelectedNodes</span>()</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="kw">setNodeColorBypass</span>(nodes,<span class="dt">new.colors=</span><span class="st">&#39;#FF0088&#39;</span>)</a></code></pre></div>
</div>
<p>Here the string matching is based on discrete values but it can be from a continuous variable?</p>
<p><strong>Can you select a few nodes based on your favorite column and see whether you can map some column as node attributes?</strong></p>
</div>
<div id="generate-own-networks-using-co-expression-analyse" class="section level2">
<h2><span class="header-section-number">1.10</span> Generate own networks using co-expression analyse</h2>
<p>With the following block of code one can perform co-expression analyses. Here you are already provided with correlation matrix that you can use to follow the steps.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># scale the data if required</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="co"># RNASeq_expression &lt;- scale(NASeq_expression, center = TRUE, scale = TRUE)</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="co"># #rownames(RNASeq_expression) &lt;- RNASeq_expression_matrix$Name</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="co"># RNAseq_correlation_matrix &lt;- cor(t(RNASeq_expression), method=&quot;pearson&quot;)</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="co"># </span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="co"># #set the diagonal of matrix to zero - eliminate self-correlation</span></a>
<a class="sourceLine" id="cb41-8" data-line-number="8"><span class="co"># RNAseq_correlation_matrix[ row(RNAseq_correlation_matrix) == col(RNAseq_correlation_matrix) ] &lt;- 0</span></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="co"># </span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="co"># # set all correlations that are less than 0.7 to zero</span></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="co"># RNAseq_correlation_matrix[which(RNAseq_correlation_matrix&lt;0.60)] &lt;- 0</span></a>
<a class="sourceLine" id="cb41-12" data-line-number="12"><span class="co"># </span></a>
<a class="sourceLine" id="cb41-13" data-line-number="13"><span class="co"># #get rid of rows and columns that have no correlations with the above thresholds</span></a>
<a class="sourceLine" id="cb41-14" data-line-number="14"><span class="co"># RNAseq_correlation_matrix &lt;- RNAseq_correlation_matrix[which(rowSums(RNAseq_correlation_matrix) != 0),</span></a>
<a class="sourceLine" id="cb41-15" data-line-number="15"><span class="co">#                           which(colSums(RNAseq_correlation_matrix) !=0)]</span></a>
<a class="sourceLine" id="cb41-16" data-line-number="16"><span class="co"># </span></a>
<a class="sourceLine" id="cb41-17" data-line-number="17"><span class="co"># #correlation_filename &lt;- file.path(getwd(),  &quot;Data&quot;, &quot;Protein_correlation_matrix.txt&quot;) </span></a>
<a class="sourceLine" id="cb41-18" data-line-number="18"><span class="co"># </span></a>
<a class="sourceLine" id="cb41-19" data-line-number="19"><span class="co"># write.table( RNAseq_correlation_matrix ,  file = correlation_filename, col.names  = TRUE, row.names = FALSE, sep = &quot;\t&quot;, quote=FALSE)</span></a></code></pre></div>
</div>
<p>Use the CyRest call to access the aMatReader functionality.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">correlation_filename &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">getwd</span>(),  <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Protein_correlation_matrix.txt&quot;</span>) </a>
<a class="sourceLine" id="cb42-2" data-line-number="2"></a>
<a class="sourceLine" id="cb42-3" data-line-number="3">amat_url &lt;-<span class="st"> &quot;aMatReader/v1/import&quot;</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4">amat_params =<span class="st"> </span><span class="kw">list</span>(<span class="dt">files =</span> <span class="kw">list</span>(correlation_filename),</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">                   <span class="dt">delimiter =</span> <span class="st">&quot;TAB&quot;</span>,</a>
<a class="sourceLine" id="cb42-6" data-line-number="6">                   <span class="dt">undirected =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">                   <span class="dt">ignoreZeros =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb42-8" data-line-number="8">                   <span class="dt">interactionName =</span> <span class="st">&quot;correlated with&quot;</span>,</a>
<a class="sourceLine" id="cb42-9" data-line-number="9">                   <span class="dt">rowNames =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb42-10" data-line-number="10">                   )</a>
<a class="sourceLine" id="cb42-11" data-line-number="11"> </a>
<a class="sourceLine" id="cb42-12" data-line-number="12">response &lt;-<span class="st"> </span><span class="kw">cyrestPOST</span>(<span class="dt">operation =</span> amat_url, <span class="dt">body =</span> amat_params, <span class="dt">base.url =</span> <span class="st">&quot;http://localhost:1234&quot;</span>)</a>
<a class="sourceLine" id="cb42-13" data-line-number="13"></a>
<a class="sourceLine" id="cb42-14" data-line-number="14">current_network_id &lt;-<span class="st"> </span>response<span class="op">$</span>data[<span class="st">&quot;suid&quot;</span>]</a></code></pre></div>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">layoutNetwork</span>(<span class="st">&#39;cose&#39;</span>,<span class="dt">network =</span> <span class="kw">as.numeric</span>(current_network_id))</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="kw">renameNetwork</span>(<span class="dt">title =</span> <span class="st">&quot;Coexpression_network&quot;</span>,</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">              <span class="dt">network =</span> current_network_id)</a></code></pre></div>
</div>
<p>One can map column attributes as we did in case of string database based on our desired attributes.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">?loadTableData</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="kw">loadTableData</span>(<span class="dt">data=</span> <span class="kw">as.data.frame</span>(Age_prot),  <span class="dt">table.key.column =</span> <span class="st">&quot;name&quot;</span>, <span class="dt">data.key.column=</span> <span class="st">&quot;protein&quot;</span>)  <span class="co">#default data.frame key is row.names</span></a></code></pre></div>
<pre><code>## [1] &quot;Failed to load data: Please check data.key.column&quot;</code></pre>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">createColumnFilter</span>(<span class="dt">filter.name=</span><span class="st">&#39;Fold change&#39;</span>, <span class="dt">column=</span><span class="st">&quot;logFC&quot;</span>, <span class="fl">0.01</span>, <span class="st">&quot;GREATER_THAN&quot;</span>, <span class="dt">network =</span> <span class="st">&quot;Coexpression_network&quot;</span>)</a></code></pre></div>
<pre><code>## $nodes
##  [1] &quot;Q9Y6R7&quot; &quot;P04275&quot; &quot;P10643&quot; &quot;P02741&quot; &quot;P23142&quot; &quot;Q06033&quot; &quot;Q14118&quot; &quot;P61626&quot; &quot;Q9UBX5&quot; &quot;P36222&quot; &quot;P41222&quot; &quot;Q12805&quot; &quot;P02760&quot;
## [14] &quot;P08493&quot; &quot;P01034&quot; &quot;P39060&quot; &quot;Q14767&quot; &quot;P08294&quot; &quot;P00746&quot; &quot;P20774&quot; &quot;P61769&quot;
## 
## $edges
## [1] NA</code></pre>
</div>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">nodes &lt;-<span class="st"> </span><span class="kw">getSelectedNodes</span>()</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="kw">setNodeColorBypass</span>(nodes,<span class="dt">new.colors=</span><span class="st">&#39;#FF0088&#39;</span>)</a></code></pre></div>
</div>
</div>
<div id="bonus-exercises" class="section level2">
<h2><span class="header-section-number">1.11</span> Bonus exercises</h2>
<p>Create consensus scores to the respective gene and methylation data-sets, create and network based on string db. Map attributes where both gene expression and methylation data agrees most.</p>
<div class="block-title-parent">
<div class="block-title small">
R
</div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="co">## Create attributes for the &quot;Age&quot; dataset</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"></a>
<a class="sourceLine" id="cb49-3" data-line-number="3">AgeingExpMeth<span class="op">$</span>ExpAgeUp &lt;-<span class="st"> </span>AgeingExpMeth<span class="op">$</span>ExpAgeDirection <span class="op">%&gt;%</span><span class="st"> </span>stringi<span class="op">::</span><span class="kw">stri_count</span>( <span class="dt">regex =</span> <span class="st">&quot;[+]&quot;</span>)</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">AgeingExpMeth<span class="op">$</span>ExpAgeDown &lt;-<span class="st"> </span>AgeingExpMeth<span class="op">$</span>ExpAgeDirection <span class="op">%&gt;%</span><span class="st"> </span>stringi<span class="op">::</span><span class="kw">stri_count</span>( <span class="dt">regex =</span> <span class="st">&quot;[-]&quot;</span>)</a>
<a class="sourceLine" id="cb49-5" data-line-number="5"></a>
<a class="sourceLine" id="cb49-6" data-line-number="6">AgeingExpMeth<span class="op">$</span>MethAgeUp &lt;-<span class="st"> </span>AgeingExpMeth<span class="op">$</span>MethAgeDirection <span class="op">%&gt;%</span><span class="st"> </span>stringi<span class="op">::</span><span class="kw">stri_count</span>( <span class="dt">regex =</span> <span class="st">&quot;[+]&quot;</span>)</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">AgeingExpMeth<span class="op">$</span>MethAgeDown &lt;-<span class="st"> </span>AgeingExpMeth<span class="op">$</span>MethAgeDirection <span class="op">%&gt;%</span><span class="st"> </span>stringi<span class="op">::</span><span class="kw">stri_count</span>( <span class="dt">regex =</span> <span class="st">&quot;[-]&quot;</span>)</a>
<a class="sourceLine" id="cb49-8" data-line-number="8"></a>
<a class="sourceLine" id="cb49-9" data-line-number="9">AgeingExpMeth<span class="op">$</span>ExpMethUp &lt;-<span class="st"> </span>AgeingExpMeth<span class="op">$</span>ExpMethDirection <span class="op">%&gt;%</span><span class="st"> </span>stringi<span class="op">::</span><span class="kw">stri_count</span>( <span class="dt">regex =</span> <span class="st">&quot;[+]&quot;</span>)</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">AgeingExpMeth<span class="op">$</span>ExpMethDown &lt;-<span class="st"> </span>AgeingExpMeth<span class="op">$</span>ExpMethDirection <span class="op">%&gt;%</span><span class="st"> </span>stringi<span class="op">::</span><span class="kw">stri_count</span>( <span class="dt">regex =</span> <span class="st">&quot;[-]&quot;</span>)</a></code></pre></div>
</div>
<hr />
</div>
<div id="end-the-session" class="section level2">
<h2><span class="header-section-number">1.12</span> End the session</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
